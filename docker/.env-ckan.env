# Runtime configuration of CKAN enabled through ckanext-envvars
# Information about how it works: https://github.com/okfn/ckanext-envvars
# Note that variables here take presedence over build/up time variables in .env

# Set to true to disable CKAN from starting and serve a maintenance page
MAINTENANCE_MODE=false


POSTGRES_PASSWORD=ckan
POSTGRES_USER=postgres
POSTGRES_PORT=5432

CKAN_SQLALCHEMY_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@db/ckan
CKAN_SOLR_URL=http://solr:8983/solr/ckan
CKAN_REDIS_URL=redis://redis:6379/1
CKAN_SITE_URL=${CKAN_SITE_URL}
CKAN_MAX_UPLOAD_SIZE_MB=${CKAN_MAX_UPLOAD_SIZE_MB}

DATASTORE_READONLY_USER=datastore
DATASTORE_READONLY_PASSWORD=datastore

#DB CONNECTION STRINGS
CKAN_DATASTORE_WRITE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@db/datastore
CKAN_DATASTORE_READ_URL=postgresql://${DATASTORE_READONLY_USER}:${DATASTORE_READONLY_PASSWORD}@db/datastore

# General Settings
CKAN_VERSION=2.9.5
CKAN_SITE_ID=default
CKAN_SITE_URL=http://localhost:5000
CKAN_PORT=5000
CKAN__MAX_UPLOAD_SIZE_MB=512
CKAN__MAX_RESOURCE_SIZE=512

# CKAN Plugins
CKAN__PLUGINS=envvars image_view text_view recline_view datastore datapusher

# CKAN requires storage path to be set in order for filestore to be enabled
CKAN__STORAGE_PATH=/srv/app/data
CKAN__WEBASSETS__PATH=/srv/app/data/webassets

# SYSADMIN settings, a sysadmin user is created automatically with the below credentials
CKAN_SYSADMIN_NAME=sysadmin
CKAN_SYSADMIN_PASSWORD=OhSnapThatsThePassword123!
CKAN_SYSADMIN_EMAIL=sysadmin@ckantest.com

# Email settings
# CKAN_SMTP_SERVER=smtp.corporateict.domain:25
# CKAN_SMTP_STARTTLS=True
# CKAN_SMTP_USER=user
# CKAN_SMTP_PASSWORD=pass
# CKAN_SMTP_MAIL_FROM=ckan@localhost

# Datapusher configuration
CKAN__DATAPUSHER__URL=http://datapusher:8800
CKAN__DATAPUSHER__CALLBACK_URL_BASE=http://ckan:5000/
DATAPUSHER_VERSION=0.0.17
DATAPUSHER_MAX_CONTENT_LENGTH=512000000
DATAPUSHER_CHUNK_SIZE=16384
DATAPUSHER_CHUNK_INSERT_ROWS=250
DATAPUSHER_DOWNLOAD_TIMEOUT=30
DATAPUSHER_SSL_VERIFY=False
DATAPUSHER_REWRITE_RESOURCES=True
DATAPUSHER_REWRITE_URL=http://ckan:5000

# Harvest settings
CKAN__HARVEST__MQ__TYPE=redis
CKAN__HARVEST__MQ__HOSTNAME=redis

# Solr configuration
CKAN_VERSION=2.9.5
CKAN_CORE_NAME=ckan

# Redis
REDIS_VERSION=6.0.7

# ckanext_envvars for plugins
CKAN___BEAKER__SESSION__DATA_SERIALIZER=json
CKAN___BEAKER__SESSION__HTTPONLY=true
CKAN___BEAKER__SESSION__SECURE=true
CKAN___BEAKER__SESSION__TIMEOUT=3600
CKAN___BEAKER__SESSION__SAVE_ACCESSED_TIME=true
CKAN___BEAKER__SESSION__TYPE=ext:redis
CKAN___BEAKER__SESSION__URL=redis://redis:6379/8
CKAN___BEAKER__SESSION__COOKIE_EXPIRES=true
CKAN___BEAKER__SESSION__COOKIE_DOMAIN=localhost:5000
CKANEXT__SECURITY__DOMAIN=localhost:5000
CKANEXT__SECURITY__REDIS__HOST=redis
CKANEXT__SECURITY__REDIS__PORT=6379
CKANEXT__SECURITY__REDIS__DB=8
CKANEXT__SECURITY__LOCK_TIMEOUT=900
CKANEXT__SECURITY__LOGIN_MAX_COUNT=10
CKANEXT__SECURITY__BRUTE_FORCE_KEY=user_name
CKANEXT__SECURITY__DISABLE_PASSWORD_RESET_OVERRIDE=true
CKANEXT__SECURITY__MFA_HELP_LINK=https://localhost:5000/pages/mfa
